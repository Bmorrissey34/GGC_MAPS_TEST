(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{7507:function(e,t,r){Promise.resolve().then(r.bind(r,227))},227:function(e,t,r){"use strict";r.d(t,{default:function(){return g}});var l=r(7437),o=r(9376),n=r(2265),i=r(7244),a=r(3873),c=r(4577);r(869);var u=r(7683),s=r(6073),d=r(4695);function m(e){let{src:t,interactiveSelector:r=".room-group, .room, .label",buildingData:o,currentFloorId:m,onFloorChange:f,onRoomSelect:v}=e,[g,p]=(0,n.useState)(""),h=(0,n.useRef)(null),[S,y]=(0,u.i)(h.current,g),{locale:b}=(0,s.Z)(),x=(0,d.u0)(b);((null==o?void 0:o.floors)||[]).findIndex(e=>e.id===m);let q=e=>{e&&(y(String(e).trim()),v&&v(String(e).trim()))};return(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{let r="".concat("/ggcmaps-fall25").concat(t),l=await fetch(r,{cache:"no-cache"}),o=await l.text(),n=(0,c.S0)(o);e&&p(n)}catch(t){e&&p('<svg xmlns="http://www.w3.org/2000/svg"><text x="10" y="20">Failed to load map</text></svg>')}})(),()=>{e=!1}},[t]),(0,n.useEffect)(()=>{let e=h.current;if(!e||!g)return;let t=e.querySelector("svg");t&&(0,c.VY)(t),e.querySelectorAll("a[href]").forEach(e=>{let t=e.getAttribute("href");t&&(e.setAttribute("data-original-href",t),e.removeAttribute("href"))});let l=e=>{let t=e.target.closest(r)||e.target.closest("[id]");if(!t)return;e.preventDefault();let l=t.closest(".room-group"),o=(null==l?void 0:l.id)||t.id||t.getAttribute("id");o&&q(o.trim())};return e.addEventListener("click",l),()=>e.removeEventListener("click",l)},[g,r]),(0,l.jsxs)("div",{className:"map-wrap","data-building":null==o?void 0:o.id,children:[(0,l.jsx)(i.Z,{ref:h,initialScale:1,minScale:.1,maxScale:6,className:"map-viewport",disableDoubleClickZoom:!0,autoFit:!1,fitPadding:0,fitScaleMultiplier:.7,resetLabel:x.overlay.resetLabel,resetAriaLabel:x.overlay.resetAria,children:(0,l.jsx)("div",{className:"w-100 h-100",style:{pointerEvents:"auto"},dangerouslySetInnerHTML:{__html:g}})}),(0,l.jsx)(a.Z,{buildingData:o,currentFloorId:m,onFloorChange:f,isFloorView:!0}),S&&(0,l.jsxs)("div",{className:"map-selection-indicator",children:["Selected: ",(0,l.jsx)("strong",{children:S})]})]})}var f=r(4328);function v(e){let{buildingId:t,floorId:r,locale:i}=e,a=(0,o.useRouter)(),c=(0,o.useSearchParams)(),u=(0,f.Ml)(t),s=(null==u?void 0:u.floors)||[],v=s.findIndex(e=>e.id===r),g=s[v],p=c.get("room"),h=(0,d.u0)(i);(0,n.useEffect)(()=>{if(!p)return;let e=e=>{let t=document.querySelector(".floor-viewer");if(!t)return!1;let r=t.querySelector("svg");if(!r)return!1;r.querySelectorAll(".active-room").forEach(e=>e.classList.remove("active-room"));let l=r.querySelector('g.room-group[id="'.concat(e,'"]'))||r.querySelector('g[id="'.concat(e,'"]'));if(!l)return!1;let o=l.querySelector(".room")||l.querySelector("rect, polygon, path"),n=l.querySelector(".label")||l.querySelector("text");return o&&o.classList.add("active-room"),n&&n.classList.add("label--active"),(null==o?void 0:o.parentElement)&&o.parentElement.appendChild(o),(null==n?void 0:n.parentElement)&&n.parentElement.appendChild(n),!0},t=function(r){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;e(r)||l<=0||setTimeout(()=>t(r,l-1,o),o)};t(p)},[p]);let S=(0,n.useCallback)(e=>{(e=>{let t=document.querySelector(".floor-viewer");if(!t)return;let r=t.querySelector("svg");if(!r)return;r.querySelectorAll(".active-room").forEach(e=>e.classList.remove("active-room"));let l=r.querySelector('g.room-group[id="'.concat(e,'"]'))||r.querySelector('g[id="'.concat(e,'"]'));if(!l)return;let o=l.querySelector(".room")||l.querySelector("rect, polygon, path"),n=l.querySelector(".label")||l.querySelector("text");return o&&o.classList.add("active-room"),n&&n.classList.add("label--active"),(null==o?void 0:o.parentElement)&&o.parentElement.appendChild(o),(null==n?void 0:n.parentElement)&&n.parentElement.appendChild(n)})(e)},[]);return u&&g?(0,l.jsx)("main",{role:"main",className:"floor-viewer",children:(0,l.jsx)(m,{src:g.file,buildingData:u,currentFloorId:r,onFloorChange:e=>{a.push("/building/".concat(t,"/").concat(e))},onRoomSelect:S})}):(0,l.jsx)("div",{children:h.general.notFound})}function g(e){let{buildingId:t,floorId:r}=e,{locale:o}=(0,s.Z)(),i=(0,d.u0)(o);return(0,l.jsx)(n.Suspense,{fallback:(0,l.jsx)("div",{children:i.general.loading}),children:(0,l.jsx)(v,{buildingId:t,floorId:r,locale:o})})}}},function(e){e.O(0,[648,925,971,117,744],function(){return e(e.s=7507)}),_N_E=e.O()}]);