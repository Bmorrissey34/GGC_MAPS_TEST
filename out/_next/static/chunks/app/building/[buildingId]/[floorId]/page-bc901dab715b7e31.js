(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{8528:function(e,t,r){Promise.resolve().then(r.bind(r,3031))},3031:function(e,t,r){"use strict";r.d(t,{default:function(){return h}});var l=r(7437),o=r(9376),i=r(2265),n=r(7244),a=r(3873),c=r(4577);r(869);var u=r(7683),s=r(6073),d=r(4695);function m(e){let{src:t,interactiveSelector:r=".room-group, .room, .label",buildingData:o,currentFloorId:m,onFloorChange:f,onRoomSelect:v}=e,[h,g]=(0,i.useState)(""),p=(0,i.useRef)(null),[y,S]=(0,u.i)(p.current,h),{locale:b}=(0,s.Z)(),q=(0,d.u0)(b);((null==o?void 0:o.floors)||[]).findIndex(e=>e.id===m);let x=e=>{e&&(S(String(e).trim()),v&&v(String(e).trim()))};return(0,i.useEffect)(()=>{let e=!0;return(async()=>{try{let r=await fetch(t,{cache:"no-cache"}),l=await r.text(),o=(0,c.S0)(l);e&&g(o)}catch(t){e&&g('<svg xmlns="http://www.w3.org/2000/svg"><text x="10" y="20">Failed to load map</text></svg>')}})(),()=>{e=!1}},[t]),(0,i.useEffect)(()=>{let e=p.current;if(!e||!h)return;let t=e.querySelector("svg");t&&(t.removeAttribute("width"),t.removeAttribute("height"),t.style.width="100%",t.style.height="auto",t.style.display="block"),e.querySelectorAll("a[href]").forEach(e=>{let t=e.getAttribute("href");t&&(e.setAttribute("data-original-href",t),e.removeAttribute("href"))});let l=e=>{let t=e.target.closest(r)||e.target.closest("[id]");if(!t)return;e.preventDefault();let l=t.closest(".room-group"),o=(null==l?void 0:l.id)||t.id||t.getAttribute("id");o&&x(o.trim())};return e.addEventListener("click",l),()=>e.removeEventListener("click",l)},[h,r]),(0,l.jsxs)("div",{className:"map-wrap","data-building":null==o?void 0:o.id,children:[(0,l.jsx)(n.Z,{ref:p,initialScale:1,minScale:.1,maxScale:6,className:"map-viewport",disableDoubleClickZoom:!0,autoFit:!1,fitPadding:0,fitScaleMultiplier:.7,resetLabel:q.overlay.resetLabel,resetAriaLabel:q.overlay.resetAria,children:(0,l.jsx)("div",{className:"w-100 h-100",style:{pointerEvents:"auto"},dangerouslySetInnerHTML:{__html:h}})}),(0,l.jsx)(a.Z,{buildingData:o,currentFloorId:m,onFloorChange:f,isFloorView:!0})]})}var f=r(4328);function v(e){let{buildingId:t,floorId:r,locale:n}=e,a=(0,o.useRouter)(),c=(0,o.useSearchParams)(),u=(0,f.Ml)(t),s=(null==u?void 0:u.floors)||[],v=s.findIndex(e=>e.id===r),h=s[v],g=c.get("room"),p=(0,d.u0)(n);(0,i.useEffect)(()=>{if(!g)return;let e=e=>{let t=document.querySelector(".floor-viewer");if(!t)return!1;let r=t.querySelector("svg");if(!r)return!1;r.querySelectorAll(".active-room").forEach(e=>e.classList.remove("active-room"));let l=r.querySelector('g.room-group[id="'.concat(e,'"]'))||r.querySelector('g[id="'.concat(e,'"]'));if(!l)return!1;let o=l.querySelector(".room")||l.querySelector("rect, polygon, path"),i=l.querySelector(".label")||l.querySelector("text");return o&&o.classList.add("active-room"),i&&i.classList.add("label--active"),(null==o?void 0:o.parentElement)&&o.parentElement.appendChild(o),(null==i?void 0:i.parentElement)&&i.parentElement.appendChild(i),!0},t=function(r){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;e(r)||l<=0||setTimeout(()=>t(r,l-1,o),o)};t(g)},[g]);let y=(0,i.useCallback)(e=>{(e=>{let t=document.querySelector(".floor-viewer");if(!t)return;let r=t.querySelector("svg");if(!r)return;r.querySelectorAll(".active-room").forEach(e=>e.classList.remove("active-room"));let l=r.querySelector('g.room-group[id="'.concat(e,'"]'))||r.querySelector('g[id="'.concat(e,'"]'));if(!l)return;let o=l.querySelector(".room")||l.querySelector("rect, polygon, path"),i=l.querySelector(".label")||l.querySelector("text");return o&&o.classList.add("active-room"),i&&i.classList.add("label--active"),(null==o?void 0:o.parentElement)&&o.parentElement.appendChild(o),(null==i?void 0:i.parentElement)&&i.parentElement.appendChild(i)})(e)},[]);return u&&h?(0,l.jsx)("main",{role:"main",className:"floor-viewer",children:(0,l.jsx)(m,{src:h.file,buildingData:u,currentFloorId:r,onFloorChange:e=>{a.push("/building/".concat(t,"/").concat(e))},onRoomSelect:y})}):(0,l.jsx)("div",{children:p.general.notFound})}function h(e){let{buildingId:t,floorId:r}=e,{locale:o}=(0,s.Z)(),n=(0,d.u0)(o);return(0,l.jsx)(i.Suspense,{fallback:(0,l.jsx)("div",{children:n.general.loading}),children:(0,l.jsx)(v,{buildingId:t,floorId:r,locale:o})})}}},function(e){e.O(0,[648,925,971,117,744],function(){return e(e.s=8528)}),_N_E=e.O()}]);